using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.Tilemaps;

public class Player : MonoBehaviour
{
   public InventoryManager inventory;
   public TileChange tilechanger;
   public PlantSeed plantSeed;

   public Tilemap tilemap;
   public Tile targetTile;

   private void Awake() 
   {
      inventory = GetComponent<InventoryManager>();
      tilechanger = GetComponent<TileChange>();
      plantSeed = GetComponent<PlantSeed>();
   }
   private void Update(){
      Vector3 mousePosition = Camera.main.ScreenToWorldPoint(Input.mousePosition);
      mousePosition.z = 0;
      Vector3Int cellPosition = tilemap.WorldToCell(mousePosition);
      TileBase clickedTile = tilemap.GetTile(cellPosition);

      if(Input.GetMouseButtonDown(0) && inventory.toolbar.selectedSlot.itemName == "Hoe"){
         tilechanger.farm();
      }
      if(Input.GetMouseButtonDown(0) && clickedTile == targetTile && inventory.toolbar.selectedSlot.itemName == "LettuceSeed"){
         plantSeed.PlantSeedOnTile();
      }
   }
   public void DropItem(Item item) 
   {
      Vector2 spawnLocation = transform.position;

      Vector2 spawnOffset = Random.insideUnitCircle * 3f;

      Item droppedItem = Instantiate(item, spawnLocation + spawnOffset, Quaternion.identity);   
   
      droppedItem.rb2d.AddForce(spawnOffset *.2f, ForceMode2D.Impulse);
   }
   public void DropItem(Item item, int numToDrop) 
   {
      for (int i = 0 ; i < numToDrop ; i ++) {
         DropItem(item);
      }
   }
}
